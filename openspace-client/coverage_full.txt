
> openspace-client@0.0.0 test:coverage
> vitest run --coverage


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/Users/Shared/dev/openspace/openspace-client[39m
      [2mCoverage enabled with [22m[33mv8[39m

(node:42571) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42574) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42568) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42575) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42569) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42572) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42573) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould show dialog when show is called
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould close dialog when close method is called
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould close dialog when X button is clicked
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould render custom content in dialog
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould render dialog with proper overlay
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould support replacing dialog content with new show call
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/context/DialogContext.test.tsx[2m > [22m[2mDialogContext[2m > [22m[2mshould support replacing dialog content with new show call
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32m‚úì[39m src/components/ContextMeter.test.tsx [2m([22m[2m16 tests[22m[2m)[22m[33m 3466[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render with basic props [33m 964[2mms[22m[39m
     [33m[2m‚úì[22m[39m should show tooltip on hover with all metrics [33m 654[2mms[22m[39m
     [33m[2m‚úì[22m[39m should display correct token value in tooltip [33m 469[2mms[22m[39m
     [33m[2m‚úì[22m[39m should display correct percentage in tooltip [33m 351[2mms[22m[39m
[90mstderr[2m | src/App.test.tsx[2m > [22m[2mApp[2m > [22m[2mProject Management[2m > [22m[2mshould add new project when dialog confirms
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32m‚úì[39m src/context/DialogContext.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 3354[2mms[22m[39m
     [33m[2m‚úì[22m[39m should show dialog when show is called [33m 1314[2mms[22m[39m
     [33m[2m‚úì[22m[39m should close dialog when close method is called [33m 535[2mms[22m[39m
     [33m[2m‚úì[22m[39m should close dialog when X button is clicked [33m 521[2mms[22m[39m
     [33m[2m‚úì[22m[39m should support replacing dialog content with new show call [33m 494[2mms[22m[39m
 [32m‚úì[39m src/components/AgentSelector.test.tsx [2m([22m[2m9 tests[22m[2m)[22m[33m 3768[2mms[22m[39m
     [33m[2m‚úì[22m[39m should capitalize the selected agent name [33m 830[2mms[22m[39m
     [33m[2m‚úì[22m[39m should open popover when trigger button is clicked [33m 1044[2mms[22m[39m
     [33m[2m‚úì[22m[39m should call onChange when an agent is selected [33m 580[2mms[22m[39m
     [33m[2m‚úì[22m[39m should show check icon next to selected agent [33m 350[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render all provided agents in the dropdown [33m 363[2mms[22m[39m
[90mstderr[2m | src/App.test.tsx[2m > [22m[2mApp[2m > [22m[2mEdge Cases[2m > [22m[2mshould extract project name from path correctly
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32m‚úì[39m src/App.test.tsx [2m([22m[2m19 tests[22m[2m)[22m[33m 2876[2mms[22m[39m
       [33m[2m‚úì[22m[39m should show main app when connected [33m 315[2mms[22m[39m
       [33m[2m‚úì[22m[39m should switch active project when clicking project button [33m 1091[2mms[22m[39m
       [33m[2m‚úì[22m[39m should add new project when dialog confirms [33m 358[2mms[22m[39m
       [33m[2m‚úì[22m[39m should extract project name from path correctly [33m 328[2mms[22m[39m
 [31m‚ùØ[39m src/components/MessageList.test.tsx [2m([22m[2m24 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 2174[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render empty message list [33m 302[2mms[22m[39m
     [32m‚úì[39m should render user message with timestamp[32m 214[2mms[22m[39m
     [32m‚úì[39m should render assistant message with different background[32m 104[2mms[22m[39m
     [32m‚úì[39m should render messages in chronological order[32m 62[2mms[22m[39m
     [32m‚úì[39m should render text part with markdown[32m 104[2mms[22m[39m
     [32m‚úì[39m should render inline code correctly[32m 35[2mms[22m[39m
     [32m‚úì[39m should render code blocks with syntax highlighting[32m 197[2mms[22m[39m
     [32m‚úì[39m should render reasoning part with italic styling[32m 25[2mms[22m[39m
     [32m‚úì[39m should render tool part with button[32m 21[2mms[22m[39m
[31m     [31m√ó[31m should render tool part with expandable button[39m[32m 65[2mms[22m[39m
     [32m‚úì[39m should render multiple parts for a message[32m 41[2mms[22m[39m
     [32m‚úì[39m should render error message for assistant message[32m 20[2mms[22m[39m
     [32m‚úì[39m should render error name when message is not a string[32m 24[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render copy button for messages [33m 761[2mms[22m[39m
     [32m‚úì[39m should show pending indicator when isPending is true[32m 19[2mms[22m[39m
     [32m‚úì[39m should not show pending indicator when isPending is false[32m 18[2mms[22m[39m
     [32m‚úì[39m should show elapsed time in pending indicator[32m 33[2mms[22m[39m
     [32m‚úì[39m should reset elapsed time when isPending becomes false[32m 24[2mms[22m[39m
     [32m‚úì[39m should handle messages with no parts[32m 20[2mms[22m[39m
     [32m‚úì[39m should render ScrollArea with scrollbar[32m 9[2mms[22m[39m
     [32m‚úì[39m should show tool count in StepsFlow summary[32m 18[2mms[22m[39m
     [32m‚úì[39m should show combined summary when both reasoning and tools present[32m 15[2mms[22m[39m
     [32m‚úì[39m should render file part with filename[32m 20[2mms[22m[39m
     [32m‚úì[39m should render file part with url when no filename[32m 8[2mms[22m[39m
 [32m‚úì[39m src/components/ModelSelector.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 3832[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render with models [33m 1360[2mms[22m[39m
     [33m[2m‚úì[22m[39m should open popover when trigger button is clicked [33m 600[2mms[22m[39m
     [33m[2m‚úì[22m[39m should filter by provider name [33m 663[2mms[22m[39m
     [33m[2m‚úì[22m[39m should filter by model ID [33m 354[2mms[22m[39m
     [33m[2m‚úì[22m[39m should call onChange when model button is clicked [33m 348[2mms[22m[39m
(node:42667) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42666) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42675) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42676) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/components/AgentConsole.integration.test.tsx[2m > [22m[2mAgentConsole Integration[2m > [22m[2mshould handle prompt submission when session exists
[22m[39m[MSW] Warning: intercepted a request without a matching request handler:

  ‚Ä¢ POST /session/test-session-123/message?directory=%2FUsers%2FShared%2Fdev%2Fopenspace

  ‚Ä¢ Request body: {"agent":"build","model":{"providerID":"openai","modelID":"gpt-4"},"parts":[{"type":"text","text":"Hello AI"}]}

If you still wish to intercept this unhandled request, please create a request handler for it.
Read more: https://mswjs.io/docs/http/intercepting-requests

(node:42677) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mData Fetching[2m > [22m[2mshould fetch and transform models successfully
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mData Fetching[2m > [22m[2mshould only include models from connected providers
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mData Fetching[2m > [22m[2mshould transform provider models into flat ModelOption array
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mData Fetching[2m > [22m[2mshould include context limits when available
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mData Fetching[2m > [22m[2mshould sort models alphabetically by name
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mDefault Model Selection[2m > [22m[2mshould set default model from provider defaults
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mDefault Model Selection[2m > [22m[2mshould fallback to first model if no default specified
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

(node:42678) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mDefault Model Selection[2m > [22m[2mshould skip opencode provider when selecting default
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/components/AgentConsole.integration.test.tsx [2m([22m[2m11 tests[22m[2m)[22m[33m 4017[2mms[22m[39m
     [33m[2m‚úì[22m[39m should render all console components [33m 539[2mms[22m[39m
     [33m[2m‚úì[22m[39m should allow typing in prompt input [33m 1235[2mms[22m[39m
     [33m[2m‚úì[22m[39m should handle prompt submission when session exists [33m 744[2mms[22m[39m
     [33m[2m‚úì[22m[39m should enable submit button only when prompt has content [33m 640[2mms[22m[39m
[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle empty connected providers list
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle provider with no models
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/hooks/useAdditionalHooks.test.tsx [2m([22m[2m11 tests[22m[2m)[22m[33m 953[2mms[22m[39m
[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle API error gracefully
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/components/TopBar.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[33m 1715[2mms[22m[39m
     [33m[2m‚úì[22m[39m should toggle left sidebar expanded state when clicked [33m 1046[2mms[22m[39m
[90mstderr[2m | src/hooks/useModels.test.tsx[2m > [22m[2museModels[2m > [22m[2mQuery Configuration[2m > [22m[2mshould be able to refetch data
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/hooks/useModels.test.tsx [2m([22m[2m13 tests[22m[2m)[22m[33m 974[2mms[22m[39m
 [32m‚úì[39m src/components/PromptInput.test.tsx [2m([22m[2m16 tests[22m[2m)[22m[33m 2094[2mms[22m[39m
     [33m[2m‚úì[22m[39m should call onChange when user types [33m 1020[2mms[22m[39m
 [32m‚úì[39m src/components/ConnectionStatus.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 978[2mms[22m[39m
     [33m[2m‚úì[22m[39m should call onRetry when retry button is clicked [33m 763[2mms[22m[39m
[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould connect to MCP server
[22m[39m[MSW] Warning: intercepted a request without a matching request handler:

  ‚Ä¢ POST /mcp/test-server/connect?directory=%2FUsers%2FShared%2Fdev%2Fopenspace

If you still wish to intercept this unhandled request, please create a request handler for it.
Read more: https://mswjs.io/docs/http/intercepting-requests

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould connect to MCP server
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould disconnect from MCP server
[22m[39m[MSW] Warning: intercepted a request without a matching request handler:

  ‚Ä¢ POST /mcp/test-server/disconnect?directory=%2FUsers%2FShared%2Fdev%2Fopenspace

If you still wish to intercept this unhandled request, please create a request handler for it.
Read more: https://mswjs.io/docs/http/intercepting-requests

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould disconnect from MCP server
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould update query cache on success
[22m[39m[MSW] Warning: intercepted a request without a matching request handler:

  ‚Ä¢ POST /mcp/test-server/connect?directory=%2FUsers%2FShared%2Fdev%2Fopenspace

If you still wish to intercept this unhandled request, please create a request handler for it.
Read more: https://mswjs.io/docs/http/intercepting-requests

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould update query cache on success
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould return MCP status after toggle
[22m[39m[MSW] Warning: intercepted a request without a matching request handler:

  ‚Ä¢ POST /mcp/test-server/connect?directory=%2FUsers%2FShared%2Fdev%2Fopenspace

If you still wish to intercept this unhandled request, please create a request handler for it.
Read more: https://mswjs.io/docs/http/intercepting-requests

[90mstderr[2m | src/hooks/useMcp.test.tsx[2m > [22m[2museMcpToggle[2m > [22m[2mshould return MCP status after toggle
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/hooks/useMcp.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[33m 813[2mms[22m[39m
(node:42694) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42695) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42696) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:42697) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/services/OpenCodeClient.test.ts[2m > [22m[2mOpenCodeService[2m > [22m[2mConnection Status[2m > [22m[2mshould set isConnected to false on connection failure
[22m[39mFailed to connect to OpenCode server: Error: Network error
    at [90m/Users/Shared/dev/openspace/openspace-client/[39msrc/services/OpenCodeClient.test.ts:78:85
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/OpenCodeClient.test.ts[2m > [22m[2mOpenCodeService[2m > [22m[2mConnection Status[2m > [22m[2mshould handle server 500 error gracefully
[22m[39mFailed to connect to OpenCode server: Error: Internal server error
    at [90m/Users/Shared/dev/openspace/openspace-client/[39msrc/services/OpenCodeClient.test.ts:90:85
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

(node:42698) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/services/OpenCodeClient.test.ts[2m > [22m[2mOpenCodeService[2m > [22m[2mConnection Status[2m > [22m[2mshould update connection status on subsequent checks
[22m[39mFailed to connect to OpenCode server: Error: Network error
    at [90m/Users/Shared/dev/openspace/openspace-client/[39msrc/services/OpenCodeClient.test.ts:127:85
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/services/OpenCodeClient.test.ts[2m > [22m[2mOpenCodeService[2m > [22m[2mError Scenarios[2m > [22m[2mshould handle 401 Unauthorized
[22m[39mFailed to connect to OpenCode server: Error: Unauthorized
    at [90m/Users/Shared/dev/openspace/openspace-client/[39msrc/services/OpenCodeClient.test.ts:170:85
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/services/OpenCodeClient.test.ts[2m > [22m[2mOpenCodeService[2m > [22m[2mError Scenarios[2m > [22m[2mshould handle 404 Not Found
[22m[39mFailed to connect to OpenCode server: Error: Not found
    at [90m/Users/Shared/dev/openspace/openspace-client/[39msrc/services/OpenCodeClient.test.ts:181:85
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/Shared/dev/openspace/openspace-client/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

 [32m‚úì[39m src/lib/utils.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 61[2mms[22m[39m
 [32m‚úì[39m src/services/OpenCodeClient.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 230[2mms[22m[39m
[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museAgents[2m > [22m[2mshould fetch agents successfully
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

(node:42699) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museAgents[2m > [22m[2mshould handle empty response
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/utils/storage.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 21[2mms[22m[39m
[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museConfig[2m > [22m[2mshould fetch config successfully
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museConfig[2m > [22m[2mshould be able to refetch
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/test/example.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 6[2mms[22m[39m
[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museProviders[2m > [22m[2mshould fetch providers successfully
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museProviders[2m > [22m[2mshould handle empty providers
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museMessages[2m > [22m[2mshould fetch messages for a session
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/components/FileTree.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[33m 346[2mms[22m[39m
[90mstderr[2m | src/hooks/useSimpleHooks.test.tsx[2m > [22m[2museMessages[2m > [22m[2mshould return empty array for session without messages
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32m‚úì[39m src/hooks/useSimpleHooks.test.tsx [2m([22m[2m13 tests[22m[2m)[22m[33m 521[2mms[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Failed Tests 1 [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m

[41m[1m FAIL [22m[49m src/components/MessageList.test.tsx[2m > [22mMessageList[2m > [22mshould render tool part with expandable button
[31m[1mTestingLibraryElementError[22m[39m: Unable to find an element with the text: /Thinking \+ read: /. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"h-full w-full overflow-hidden bg-white"[39m
      [33mdir[39m=[32m"ltr"[39m
      [33mstyle[39m=[32m"position: relative; --radix-scroll-area-corner-width: 0px; --radix-scroll-area-corner-height: 0px;"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-full w-full"[39m
        [33mdata-radix-scroll-area-viewport[39m=[32m""[39m
        [33mstyle[39m=[32m"overflow-x: hidden; overflow-y: scroll;"[39m
      [36m>[39m
        [36m<div[39m
          [33mstyle[39m=[32m"min-width: 100%; display: table;"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col max-w-[840px] mx-auto pb-40"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex flex-col relative"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex flex-col px-6 py-2"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mb-2 flex flex-col items-start"[39m
                [36m>[39m
                  [36m<button[39m
                    [33mclass[39m=[32m"flex max-w-full items-center gap-2 rounded-lg py-1 text-[12px] font-bold text-black/30 hover:text-black/50 transition-colors uppercase tracking-tight"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"shrink-0 flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-chevron-right"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"14"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"14"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<path[39m
                          [33md[39m=[32m"m9 18 6-6-6-6"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-brain opacity-40"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"14"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"14"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 18V5"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M17.997 5.125a4 4 0 0 1 2.526 5.77"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M18 18a4 4 0 0 0 2-7.464"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M6 18a4 4 0 0 1-2-7.464"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M6.003 5.125a4 4 0 0 0-2.526 5.77"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</div>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"truncate"[39m
                    [36m>[39m
                      [0mThinking + read: [0m
                    [36m</span>[39m
                  [36m</button>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex flex-col gap-2"[39m
                [36m/>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-2 opacity-0 hover:opacity-100 transition-opacity self-end flex items-center gap-2"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-[10px] text-black/10 font-bold uppercase tabular-nums"[39m
                  [36m>[39m
                    [0m09:48 PM[0m
                  [36m</span>[39m
                  [36m<button[39m
                    [33mclass[39m=[32m"p-1.5 rounded-lg hover:bg-black/5 transition-all text-black/30 shrink-0"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-copy"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"14"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"14"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"14"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mry[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"14"[39m
                        [33mx[39m=[32m"8"[39m
                        [33my[39m=[32m"8"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</button>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
[90m [2m‚ùØ[22m Object.getElementError node_modules/@testing-library/dom/dist/config.js:[2m37:19[22m[39m
[90m [2m‚ùØ[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m76:38[22m[39m
[90m [2m‚ùØ[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m52:17[22m[39m
[90m [2m‚ùØ[22m node_modules/@testing-library/dom/dist/query-helpers.js:[2m95:19[22m[39m
[36m [2m‚ùØ[22m src/components/MessageList.test.tsx:[2m241:19[22m[39m
    [90m239| [39m
    [90m240| [39m    // Verify tool summary is visible (StepsFlow shows "Thinking + rea‚Ä¶
    [90m241| [39m    [34mexpect[39m(screen[33m.[39m[34mgetByText[39m([36m/Thinking \+ read: /[39m))[33m.[39m[34mtoBeInTheDocument[39m()
    [90m   | [39m                  [31m^[39m
    [90m242| [39m
    [90m243| [39m    [90m// Verify there's a button for expanding (the StepsFlow button)[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/1]‚éØ[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m18 passed[39m[22m[90m (19)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m219 passed[39m[22m[90m (220)[39m
[2m   Start at [22m 21:48:07
[2m   Duration [22m 16.74s[2m (transform 7.86s, setup 11.14s, import 21.79s, tests 32.20s, environment 24.53s)[22m

